
\subsection{Convex subsets and convex hull}

In many cases, we will need to discuss the sets that contain all their possible mixtures. One typically distinguishes two cases. A set is convex if it allows all possible finite mixtures. This may be too restrictive as it may not include all possible infinite mixtures. A set is closed and convex if it includes all finite mixtures and their topological limits. Given that infinite mixtures are the topological limit of finite mixtures, a closed convex set contains all infinite mixtures. However, not all topological limits can be expressed as infinite mixture. For example, on the real line $1$ can be seen as a limit of points within the open interval $(0,1)$, but not as infinite convex combination. Therefore we add the notion of $\sigma$-convex set, a set that is closed under infinite mixtures.\footnote{The mathematical properties of $\sigma$-convex sets are yet to be explored.}

\begin{mathSection}
\begin{defn}
	Let $\Ens$ be an ensemble space. We say $A \subseteq \Ens$ is \textbf{convex} if it closed under finite mixtures (i.e. $\ens[a],\ens[b] \in A$ implies $p\ens[a] + \bar{p} \ens[b] \in A$), \textbf{$\sigma$-convex} if it is closed under infinite mixtures (i.e. $\ens[a]_i \in A$ implies $\sum_i p_i \ens[a]_i \in A$ for all possible infinite mixtures) and \textbf{closed and convex} if it is both convex and topologically closed.
\end{defn}

\begin{coro}
	A closed and convex set is $\sigma$-convex. A $\sigma$-convex set is convex.
\end{coro}
\end{mathSection}

Given a set of ensembles $A$, we can ask for all ensembles that can be constructed from $A$. The hull of $A$ is the set of all finite mixtures of $A$, the $\sigma$-hull of $A$ is the set of all infinite mixtures of $A$ and the closed hull of $A$ is the set of all the topological limits of finite mixtures of $A$. Notably, the closed hull of $A$ is equivalent to the topological closure of the hull of $A$.

\begin{mathSection}
\begin{defn}
	Let $A \subseteq \Ens$ be a subset of an ensemble space. The \textbf{convex hull} of $A$, noted $\hull(A)$ is the set of all finite mixtures of elements contained in $A$ (i.e. it is the smallest convex set that contains $A$). The \textbf{$\sigma$-hull} of $A$, noted $\shull(A)$ is the set of all infinite mixtures of elements contained in $A$ (i.e. it is the smallest $\sigma$-convex set that contains $A$). The \textbf{closed hull} of $A$, noted $\chull(A)$ is the smallest closed convex set that contains $A$. 
\end{defn}

\begin{remark}
	Note that, given a set $A$, not all elements of $\chull(A)$ can be understood as infinite mixtures. That is, we can have $\shull(A) \subset \chull(A)$. For example, let $\Ens$ be the line segment $[0,1]$ and consider the set $A=\left\{\frac{1}{2^i}\right\}_{i=0}^{\infty}$. Every point in $(0,1]$ can be expressed as a finite mixture of two elements of $A$, for example, $1$ and any number smaller than the target number. However, zero cannot be expressed as a convex combination of positive numbers, and therefore it is not an infinite mixture of $A$. However, zero is the limit of the sequence, and therefore it will be in the topological closure of $A$. This shows that the difference between $\sigma$-hull and convex hull exists already in finite dimensions. The convex hull and the $\sigma$-hull, instead, are the same in finite dimensions because \href{https://en.wikipedia.org/wiki/Carath%C3%A9odory%27s_theorem_%28convex_hull%29}{CarathÃ©odory's theorem} allows us to rewrite any infinite convex combination into a finite one.
	
	For an example in which all hulls are different, consider the space of probability distributions $\Ens$ over countably many elements $X = \{x_i\}_{i=1}^{\infty}$. Let $\ens[a]_{ip} = p x_i + \bar{p} x_{i+1}$ and let $A = \left\{ \ens[a]_{ip}  \, | \, i \geq 1, p \in (0,1)  \right\} \subset \Ens$ be the set of all non-trivial mixtures of pairs of consecutive elements. A probability distribution with support over the full $X$ cannot be expressed as a finite convex combination of elements of $A$, and will therefore not be in the convex hull. However, it can be expressed as an infinite convex combination, and therefore it will be in the $\sigma$-hull. An element $x_i \in X$, is not in the $\sigma$-hull, but it will be in the closed hull, as $x_i = \lim_{p \to 1} p x_i + \bar{p} x_{i+1} = \lim_{p \to 1} \ens[a]_{ip} \in \chull(A)$.
\end{remark}

\begin{coro}
	Given $A \subseteq \Ens$, $\hull(A) \subseteq \shull(A) \subseteq \chull(A)$.
\end{coro}

\begin{proof}
	All finite mixtures are also infinite mixtures with $p_i = 0$ for all $i > n$ for some $n$. Therefore $\hull(A) \subseteq \shull(A)$. All infinite mixtures are topological limits of finite mixtures. Therefore $\shull(A) \subseteq \chull(A)$. 
\end{proof}

\begin{prop}\label{pm-es-hullProp}
	All three hull operators are closures. That is, $\hull$ satisfies the following three properties:
	\begin{enumerate}
		\item \textbf{extensive}: $A \subseteq \hull(A)$
		\item \textbf{increasing}: $A \subseteq B \implies \hull(A) \subseteq \hull(B)$
		\item \textbf{idempotent}: $\hull(\hull(A)) = \hull(A)$
	\end{enumerate}
	and similarly do $\shull$ and $\chull$.
\end{prop}

\begin{proof}
	1. Every element of $A$ is trivially a mixture of elements of $A$. Therefore $A \subseteq \hull(A)$. Since $\hull(A) \subseteq \shull(A) \subseteq \chull(A)$, $A \subseteq \shull(A)$ and $A \subseteq \chull(A)$ as well. 
	
	2. Let $\ens \in \hull(A)$. Then it is a finite mixture of some elements of $A$. Since $A \subseteq B$, then $\ens$ is also the finite mixture of some elements of $B$ and therefore $\ens \in \hull(B)$. The same logic applies to the $\sigma$-hull and closed hull replacing finite mixture with the appropriate operation.
	
	3. Since $\hull(\hull(A))$ is the smallest convex subset that contains $\hull(A)$, and since $\hull(A)$ is a convex subset, then $\hull(\hull(A))$ must be $\hull(A)$ since no smaller set can contain all elements of $\hull(A)$. The same logic applies to the $\sigma$-hull and closed hull.
\end{proof}

\begin{coro}
	A subset $A \subseteq \Ens$ is respectively convex/$\sigma$-convex/closed convex if and only if it is its own convex hull/$\sigma$-hull/closed hull.
\end{coro}

\begin{proof}
	Let $A \subseteq \Ens$ be a convex subset. By \ref{pm-es-hullProp} we have $A \subseteq \hull(A)$. By definition of convex set, we have $\hull(A) \subseteq A$. Therefore $A = \hull(A)$. Conversely, let $A \subseteq \Ens$ be a set of ensembles not necessarily convex and let $A=\hull(A)$. By definition, $\hull(A)$ is closed under finite mixture and is therefore a convex subset. The same logic applies to $\sigma$-convex and closed convex sets with the respective hulls.
\end{proof}

\begin{defn}
	We note $\mathfrak{co}_{\Ens}$ the set of all convex subsets of $\Ens$, $\mathfrak{sco}_{\Ens}$ the set of all $\sigma$-convex subsets of $\Ens$ and $\mathfrak{cco}_{\Ens}$ the set of all closed convex subsets of $\Ens$.
\end{defn}

\begin{prop}
	The sets $\mathfrak{co}_{\Ens}$, $\mathfrak{sco}_{\Ens}$ and $\mathfrak{cco}_{\Ens}$, as posets ordered by inclusion, are topped $\bigcap$-structures and therefore complete lattices.
\end{prop}

\begin{proof}
	Theorem 7.3 in Davey and Priestley's ``Introduction to Lattice and Order'' states that, given a closure operator, the set of all closures, ordered by inclusion, is a topped $\bigcap$-structure and, therefore, a complete lattice. Since $\mathfrak{co}_{\Ens}$, $\mathfrak{sco}_{\Ens}$ and $\mathfrak{cco}_{\Ens}$ are closures, the theorem applies.
\end{proof}


\begin{prop}
	The functions $\hull$, $\shull$ and $\chull$ are continuous from above. That is, given a decreasing sequence $A_i \subseteq \Ens$, $\hull(\lim\limits_{i \to \infty} A_i) = \lim\limits_{i \to \infty} \hull(A_i)$. Similarly for $\shull$ and $\chull$.
\end{prop}

\begin{proof}
	The above proposition is a consequence of the fact that the hulls are closure operations and they generate an intersection structure. This means that the intersection of hulls is the hull of the intersections.
	
	Let $A_i \subseteq \Ens$ be a decreasing sequence. That is, $A_{i+1} \subseteq A_i$. Then $A = \lim\limits_{i \to \infty} A_i = \bigcap A_i$. Since $\hull$ is order preserving, $\hull(A_i)$ is a decreasing sequence and $\lim\limits_{i \to \infty} \hull(A_i) = \bigcap \hull(A_i)$. Moreover, $\hull(A) \subseteq \hull(A_i)$ for all $i$ and therefore $\hull(A) \subseteq \bigcap \hull(A_i)$. Now let $\ens \in \hull(A)$. Then $\ens$ is a convex combination of elements of $A$. Since every element of $A$ is also an element of any $A_i$, then $\ens$ is also a convex combination of elements of $A_i$ for any $i$. Therefore $\ens \in \hull(A_i)$ for all $i$ which means $\ens \in \bigcap \hull(A_i)$ and therefore $\hull(A) \supseteq \bigcap \hull(A_i)$. Thus we have that $\hull(\lim\limits_{i \to \infty} A_i) = \lim\limits_{i \to \infty} \hull(A_i)$.
	
	Since we have only used closure properties of $\hull$, the same reasoning applies to $\shull$ and $\chull$ since they are closures.
\end{proof}

\begin{prop}
	The $\hull$ is continuous from below. That is, let $A_i \subseteq \Ens$ be an increasing sequence. Then $\hull(\lim\limits_{i \to \infty} A_i) = \lim\limits_{i \to \infty} \hull(A_i)$.
\end{prop}

\begin{proof}
	Let $A_i \subseteq \Ens$ be an increasing sequence. That is, $A_{i+1} \supseteq A_i$. Then $A = \lim\limits_{i \to \infty} A_i = \bigcup A_i$. Since $\hull$ is an increasing function, $\hull(A) \supseteq \hull(A_i)$ for all $i$ and therefore $\hull(A) \supseteq \bigcup \hull(A_i)$. Now let $\ens \in \hull(A)$. Then $\ens$ is a convex combination of finitely many elements $\ens[a]_j$ of $A$. Since $A$ is the union of all $A_i$, each $\ens[a]_j$ will be in some $A_i$. Since the sequence of $A_i$ is increasing, and there are only finitely many $\ens[a]_j$, we will find an $i$ such that $\ens[a]_j \in A_i$ for all $j$. This means that $\ens$ is a convex combination of elements of $A_i$ and therefore $\ens \in \hull(A_i) \subseteq \hull(A)$. Therefore $\hull(A) = \bigcup \hull(A_i)$ which means $\hull(\lim\limits_{i \to \infty} A_i) = \lim\limits_{i \to \infty} \hull(A_i)$.
\end{proof}


\begin{remark}
	Note that $\shull$ and $\chull$ are not, in general, continuous from below. This is because, in general, the union of closures is not the closure of the union. This is true, in particular, with topological closures, which is part of the definition of $\chull$.
	
	For example, consider the sequence $A_i = \left[0, 1-\frac{1}{i}\right) \subseteq \mathbb{R}$. These are convex sets therefore their closed hull is simply their topological closure. That is, $\chull(A_i) = \left[0, 1-\frac{1}{i}\right]$. We have $\lim\limits_{i \to \infty} A_i = \bigcup A_i = \left[0, 1\right)$ and $\lim\limits_{i \to \infty} \chull(A_i) = \bigcup \chull(A_i) = \left[0, 1\right)$ which is not a closed set and therefore different from $\chull(A) = [0,1]$. The closed hull of the limit is not the limit of the convex hull, even in a finite-dimensional space.
	
	For the $\sigma$-hull, we need an infinite-dimensional example. Conceptually, we are using the fact that a uniform distribution over the whole $[0,1]$ is the infinite convex combination of uniform distributions over countably many sets that cover the whole $[0,1]$. Let $\Ens$ be the space of probability measures defined over $[0,1] \subseteq \mathbb{R}$. Let $\{\ens[a]_i\}_{i=1}^{\infty}$ be the sequence of uniform distributions over $\left[\frac{1}{i+1}, \frac{1}{i}\right]$. Let $\ens$ be the uniform distribution over $[0,1]$. We have $\ens = \sum \frac{1}{i(i+1)} \ens[a]_i$ where $\sum \frac{1}{i(i+1)} = 1$. Therefore $\ens$ is the countable convex combination of $\ens[a]_i$. Let $A_j = \{ \ens[a]_i \, | \, i \leq j\}$. Note that $\ens[a]_i \separate \ens[a]_j$ for all $i \neq j$. Therefore, $\{\ens[a]_i\}$ are exactly all extreme points of $\shull(\bigcup A_j)$. This means that $\ens \notin \shull(A_j)$ for all $j$ while $\ens \in \shull(\bigcup A_j)$. Therefore the $\sigma$-hull of the limit is not the limit of the $\sigma$-hulls.
\end{remark}


\begin{prop}
	The topological closure of the hull is a convex set and, therefore, the closed hull.
\end{prop}

\begin{proof}
	Let $A$ be a convex set and $\bar{A}$ its topological closure. Let $\ens[a]_i, \ens[b]_i \in A$ be two sequences that converge to $\ens[a], \ens[b] \in \Ens$ respectively. We have $\ens[a], \ens[b] \in \bar{A}$ since they are topological limits. Consider $\ens_i = p \ens[a]_i + \bar{p} \ens[b]_i$. Since mixing is continuous, we have:
	\begin{equation}
		\begin{aligned}
			\ens &= p \ens[a] + \bar{p} \ens[b] = p \lim\limits_{i \to \infty} \ens[a]_i + \bar{p} \lim\limits_{i \to \infty} \ens[b]_i = \lim\limits_{i \to \infty} (p \ens[a]_i + \bar{p} \ens[b]_i) = \lim\limits_{i \to \infty} \ens_i.
		\end{aligned}
	\end{equation}
	But $\ens_i$ are finite mixtures of elements of $A$, and therefore $\ens_i \in A$ is a sequence of elements of $A$. The sequence converges, $\ens$ is the limit of a sequence of elements of $A$ and therefore $\ens \in \bar{A}$. That is, the topological closure of a convex set is also a convex set. But this means that $\bar{A}$ is a closed convex set. Since any closed convex set that contains $A$ will also need to contain $\bar{A}$, $\bar{A}$ is the closed hull of $A$.

	Let $A \subset \Ens$ be a subset not necessarily convex. Then $\hull(A)$ will be convex. Therefore its topological closure will be the closed hull of $A$.
\end{proof}
\end{mathSection}

There may be a relationship between the algebraic notion of $\sigma$-convexity and the topological notion of interior. For example, let $U$ be a convex open set. While it clearly cannot be closed convex, is it $\sigma$-convex? The idea is that convexity can only return points that are ``inside'' the set, and $\sigma$-convexity is required to fill in all the limits. If that is true, it would be natural to look at some sort of converse. Clearly, not all $\sigma$-convex sets are open, since all closed convex sets are also $\sigma$-convex. The question becomes whether, for $\sigma$-convex sets, the notion of algebraic boundary and topological boundary coincides. These questions raise the following conjectures.

\begin{conj}\label{convexOpenIsSigmaConvex}
	Let $U \subseteq \Ens$ be a convex open set. Then $U$ is $\sigma$-convex.
\end{conj}

\begin{defn}
	Given a set $A \subset \Ens$, $\ens[a] \in A$ is an internal point of $A$ if for any $\ens \in \Ens$ we can find $\ens[b] \in A$ such that $\ens[a] = p \ens + \bar{p} \ens[b]$ for some $p \in (0,1]$.
\end{defn}

\begin{conj}
	 Let $A \subseteq \Ens$ and let $\ens[a] \in \chull(A)$ be an internal point of $\chull(A)$. Then $\ens[a] \in \shull(A)$.
\end{conj}

\begin{conj}\label{interiorIsInternal}
	Let $A \subseteq \Ens$ be a $\sigma$-convex set. Then $\ens[a] \in A$ is an internal point of $A$ if and only if it is an interior point of $A$.
\end{conj}

\openproblem{Title}{label}{Tag1, Tag2}
{This is the description}

\begin{remark}
	Note that if $A$ is not convex, this is clearly not true. For example, let $A \subseteq \mathbb{R}^2$ be an annulus (i.e. the region of two concentric circles). The points on the inner circle are internal points of $A$ according to the definition, but they are not interior points. An internal point of $A$ for a $\sigma$-convex set is guaranteed to be surrounded by an open interval along any direction. The question, as usual, is if this is enough to fit an open set.
\end{remark}
